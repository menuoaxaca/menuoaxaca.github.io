<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro | MenuOaxaca</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Outfit', sans-serif; }
        .hero-gradient { background: linear-gradient(135deg, #f97316 0%, #db2777 100%); }
        .card-step { border-left: 4px solid #f97316; }
        /* Estilos para el contenedor del mapa */
        .map-container { position: relative; padding-bottom: 50%; height: 0; overflow: hidden; border-radius: 1rem; background: #e5e7eb; }
        .map-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }
    </style>
</head>
<body class="bg-gray-50">

    <header class="hero-gradient text-white py-12 px-6 text-center">
        <div class="text-3xl font-bold mb-2">MenuOaxaca</div>
        <h1 id="titulo-negocio" class="text-4xl font-extrabold capitalize">Cargando...</h1>
        <p class="opacity-90 mt-2">Configuraci贸n de men煤 basada en tu ubicaci贸n</p>
    </header>

    <main class="max-w-4xl mx-auto py-8 px-6">
        
        <div class="bg-white rounded-2xl shadow-lg p-6 mb-8 border-t-4 border-pink-500">
            <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
                 Ubicaci贸n en Mapa de: <span id="nombre-ubicacion" class="text-pink-600">...</span>
            </h2>
            <div id="wrapper-mapa" class="map-container">
                </div>
        </div>

        <div class="bg-white rounded-2xl shadow-lg p-8 card-step mb-8">
            <h2 class="text-2xl font-bold mb-6">Datos del Establecimiento</h2>
            <div class="grid md:grid-cols-2 gap-4">
                <input type="text" id="nombreNegocio" class="w-full p-3 border rounded-lg bg-gray-50 font-bold" placeholder="Nombre del Negocio">
                <input type="text" id="direccion" placeholder="Confirmar Direcci贸n Exacta" class="w-full p-3 border rounded-lg outline-none focus:ring-2 focus:ring-orange-500 md:col-span-2">
                <input type="tel" id="telefono" placeholder="WhatsApp" class="w-full p-3 border rounded-lg outline-none focus:ring-2 focus:ring-orange-500">
                <input type="email" id="correo" placeholder="Email de contacto" class="w-full p-3 border rounded-lg outline-none focus:ring-2 focus:ring-orange-500">
            </div>
        </div>

        <button onclick="enviarRegistro()" class="w-full bg-green-600 text-white py-5 rounded-2xl font-bold text-xl hover:bg-green-700 transition shadow-lg">
            Confirmar y Enviar Men煤
        </button>
    </main>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // 1. LEER LA URL AUTOMTICAMENTE
            // Si la URL es: menuoaxaca.com/criollo/ o menuoaxaca.com/casa-oaxaca
            const pathname = window.location.pathname; 
            
            // Limpiamos la ruta para obtener solo el nombre de la carpeta final
            const segmentos = pathname.split('/').filter(item => item !== "");
            let nombreExtraido = segmentos.length > 0 ? segmentos[segmentos.length - 1] : "Oaxaca";

            // Limpiamos guiones y decodificamos caracteres (ej: %20)
            const nombreLimpio = decodeURIComponent(nombreExtraido).replace(/-/g, ' ');

            // 2. ACTUALIZAR INTERFAZ
            document.getElementById('titulo-negocio').innerText = nombreLimpio;
            document.getElementById('nombre-ubicacion').innerText = nombreLimpio;
            document.getElementById('nombreNegocio').value = nombreLimpio.toUpperCase();

            // 3. CARGAR EL MAPA BASADO EN EL NOMBRE EXTRADO
            // Agregamos "Oaxaca" a la b煤squeda para mayor precisi贸n en el mapa
            const busquedaMapa = encodeURIComponent(nombreLimpio + " Oaxaca");
            const mapaIframe = `
                <iframe 
                    width="100%" 
                    height="100%" 
                    frameborder="0" 
                    scrolling="no" 
                    marginheight="0" 
                    marginwidth="0" 
                    src="https://maps.google.com/maps?q=${busquedaMapa}&t=&z=16&ie=UTF8&iwloc=&output=embed">
                </iframe>`;
            
            document.getElementById('wrapper-mapa').innerHTML = mapaIframe;
        });

        function enviarRegistro() {
            // L贸gica de WhatsApp (igual a la anterior)
            const nombre = document.getElementById('nombreNegocio').value;
            const tel = document.getElementById('telefono').value;
            if(!tel) return alert("Indica un tel茅fono de contacto");
            
            const msg = `隆Hola! Registro para socio: ${nombre}. URL detectada: ${window.location.href}`;
            window.open(`https://wa.me/2204891875?text=${encodeURIComponent(msg)}`, '_blank');
        }
    </script>
</body>
</html>
